{"remainingRequest":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/Comments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/Comments.vue","mtime":1612461286129},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb21tZW50SXRlbSBmcm9tICcuL0NvbW1lbnRJdGVtLnZ1ZSc7CmV4cG9ydCBkZWZhdWx0IHsKICAgIGNvbXBvbmVudHM6IHsgQ29tbWVudEl0ZW0gfSwKICAgIENvbW1lbnQsCiAgICBwcm9wczogewogICAgICAgIHR1dG9yaWFsSWQ6IHsKICAgICAgICAgICAgZGVmYXVsdDogJycsCiAgICAgICAgfSwKICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNvbW1lbnRzOiB7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiAnJywKICAgICAgICAgICAgfSwKICAgICAgICB9OwogICAgfSwKICAgIGFzeW5jIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5ncmFiQWxsQ29tbWVudHMoKTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgcmVsb2FkQ29tbWVudCgpIHsKICAgICAgICAgICAgdGhpcy5ncmFiQWxsQ29tbWVudHMoKTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVN1Ym1pdDogYXN5bmMgZnVuY3Rpb24gcG9zdENvbW1lbnQoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgY29tbWVudCA9IHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRfY29udGVudCcpLnZhbHVlLAogICAgICAgICAgICAgICAgICAgIHVzZXJJZDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJRCcpLAogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICB2YXIgcmVzID0gYXdhaXQgdGhpcy5heGlvcy5wb3N0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvZGlzY3Vzc2lvbi8nICsgdGhpcy50dXRvcmlhbElkLCBjb21tZW50LCB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy9pZiBzdWNjZXNzZnVsbAogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkFsbENvbW1lbnRzKCk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRfY29udGVudCcpLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgYWxlcnQoJ0FuIGVycm9yIG9jY3VyZWQ6ICcsIGVycik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ3JhYkFsbENvbW1lbnRzKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3Qgand0X3Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpOwogICAgICAgICAgICAgICAgaWYgKGp3dF90b2tlbikgewogICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLmF4aW9zLnBvc3QoCiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwOi8vbG9jYWxob3N0OjMwMDAvdmVyaWZ5UmVmcmVzaFRva2VuJywKICAgICAgICAgICAgICAgICAgICAgICAge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0X3Rva2VufWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdqd3RfdG9rZW4nLCByZXN1bHQuZGF0YS5qd3RfdG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2Rpc2N1c3Npb24vJyArIHRoaXMudHV0b3JpYWxJZCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0X3Rva2VuJyl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRzID0gcmVzdWx0LmRhdGE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBhY2Nlc3MgdGhpcyBwYWdlJyk7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJHJlZnMuTmF2YmFyLnJlbG9hZE5hdigpOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dnZWQgb3V0Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2xvZ2luJyk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRyZWZzLk5hdmJhci5yZWxvYWROYXYoKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dnZWQgb3V0Jyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["Comments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Comments.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <!-- component -->\n    <div>\n        <section class=\"rounded-b-lg mt-4\">\n            <form @submit.prevent=\"handleSubmit\" accept-charset=\"UTF-8\" method=\"post\">\n                <input type=\"hidden\" />\n                <br />\n                <textarea\n                    class=\"flex flex-wrap content-center m-auto w-2/3 shadow-inner p-4 border-0 mb-4 rounded-lg focus:shadow-outline text-2xl\"\n                    placeholder=\"Ask a question!\"\n                    cols=\"6\"\n                    rows=\"1\"\n                    id=\"comment_content\"\n                    spellcheck=\"false\"\n                ></textarea>\n                <button class=\"font-bold py-2 px-4 w-1/3 bg-purple-400 text-lg text-white shadow-md rounded-lg\">\n                    Comment\n                </button>\n            </form>\n\n            <div id=\"task-comments\" class=\"pt-4\">\n                <comment-item\n                    @reloadComments=\"reloadComment()\"\n                    v-bind:key=\"comment._id\"\n                    v-for=\"comment in comments\"\n                    :comment=\"comment\"\n                />\n            </div>\n        </section>\n    </div>\n</template>\n<script>\nimport CommentItem from './CommentItem.vue';\nexport default {\n    components: { CommentItem },\n    Comment,\n    props: {\n        tutorialId: {\n            default: '',\n        },\n    },\n    data() {\n        return {\n            comments: {\n                default: '',\n            },\n        };\n    },\n    async mounted() {\n        this.grabAllComments();\n    },\n    methods: {\n        reloadComment() {\n            this.grabAllComments();\n        },\n        handleSubmit: async function postComment() {\n            try {\n                let comment = {\n                    value: document.getElementById('comment_content').value,\n                    userId: localStorage.getItem('userID'),\n                };\n\n                var res = await this.axios.post('http://localhost:3000/discussion/' + this.tutorialId, comment, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('jwt_token')}`,\n                    },\n                });\n                //if successfull\n                if (res.status === 200) {\n                    this.grabAllComments();\n                    document.getElementById('comment_content').value = '';\n                }\n            } catch (err) {\n                alert('An error occured: ', err);\n            }\n            return false;\n        },\n        async grabAllComments() {\n            try {\n                const jwt_token = localStorage.getItem('jwt_token');\n                if (jwt_token) {\n                    let result = await this.axios.post(\n                        'http://localhost:3000/verifyRefreshToken',\n                        {},\n                        {\n                            headers: {\n                                Authorization: `Bearer ${jwt_token}`,\n                            },\n                        }\n                    );\n                    if (result.status === 200) {\n                        localStorage.setItem('jwt_token', result.data.jwt_token);\n                        result = await this.axios.get('http://localhost:3000/discussion/' + this.tutorialId, {\n                            headers: {\n                                Authorization: `Bearer ${localStorage.getItem('jwt_token')}`,\n                            },\n                        });\n                        this.comments = result.data;\n                    }\n                } else {\n                    console.log('You are not authorized to access this page');\n                    localStorage.clear();\n                    this.$router.push('/login');\n                    this.$root.$refs.Navbar.reloadNav();\n                    console.log('Logged out');\n                }\n            } catch (err) {\n                console.log(err.message);\n                localStorage.clear();\n                this.$router.push('/login');\n                this.$root.$refs.Navbar.reloadNav();\n                console.log('Logged out');\n            }\n        },\n    },\n};\n</script>\n"]}]}