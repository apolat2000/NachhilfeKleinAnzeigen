{"remainingRequest":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/tutorial/comment/Comments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/tutorial/comment/Comments.vue","mtime":1612773362631},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb21tZW50SXRlbSBmcm9tICcuL0NvbW1lbnRJdGVtLnZ1ZSc7CmV4cG9ydCBkZWZhdWx0IHsKICAgIGNvbXBvbmVudHM6IHsgQ29tbWVudEl0ZW0gfSwKICAgIENvbW1lbnQsCiAgICBwcm9wczogewogICAgICAgIHR1dG9yaWFsSWQ6IHsKICAgICAgICAgICAgZGVmYXVsdDogJycKICAgICAgICB9CiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBjb21tZW50czogewogICAgICAgICAgICAgICAgZGVmYXVsdDogJycKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICB9LAogICAgYXN5bmMgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLmdyYWJBbGxDb21tZW50cygpOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICByZWxvYWRDb21tZW50KCkgewogICAgICAgICAgICB0aGlzLmdyYWJBbGxDb21tZW50cygpOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlU3VibWl0OiBhc3luYyBmdW5jdGlvbiBwb3N0Q29tbWVudCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBjb21tZW50ID0gewogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudF9jb250ZW50JykudmFsdWUsCiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklEJykKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgdmFyIHJlcyA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2Rpc2N1c3Npb24vJyArIHRoaXMudHV0b3JpYWxJZCwgY29tbWVudCwgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2xvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3RfdG9rZW4nKX1gCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmFiQWxsQ29tbWVudHMoKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudF9jb250ZW50JykudmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBhbGVydCgnQW4gZXJyb3Igb2NjdXJlZDogJywgZXJyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBncmFiQWxsQ29tbWVudHMoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBqd3RfdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0X3Rva2VuJyk7CiAgICAgICAgICAgICAgICBpZiAoand0X3Rva2VuKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCgKICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC92ZXJpZnlSZWZyZXNoVG9rZW4nLAogICAgICAgICAgICAgICAgICAgICAgICB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3RfdG9rZW59YAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdqd3RfdG9rZW4nLCByZXN1bHQuZGF0YS5qd3RfdG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2Rpc2N1c3Npb24vJyArIHRoaXMudHV0b3JpYWxJZCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0X3Rva2VuJyl9YAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21tZW50cyA9IHJlc3VsdC5kYXRhOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gYWNjZXNzIHRoaXMgcGFnZScpOwogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvbG9naW4nKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRyZWZzLk5hdmJhci5yZWxvYWROYXYoKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9nZ2VkIG91dCcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTsKICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kcmVmcy5OYXZiYXIucmVsb2FkTmF2KCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9nZ2VkIG91dCcpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Owo="},{"version":3,"sources":["Comments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Comments.vue","sourceRoot":"src/components/tutorial/comment","sourcesContent":["<template>\n    <div>\n        <section class=\"rounded-b-lg mt-4\">\n            <form @submit.prevent=\"handleSubmit\" accept-charset=\"UTF-8\" method=\"post\">\n                <input type=\"hidden\" />\n                <br />\n                <textarea\n                    class=\"flex flex-wrap content-center m-auto w-2/3 shadow-inner p-4 border-0 mb-4 rounded-lg focus:shadow-outline text-2xl\"\n                    placeholder=\"Ask a question!\"\n                    cols=\"6\"\n                    rows=\"1\"\n                    id=\"comment_content\"\n                    spellcheck=\"false\"\n                ></textarea>\n                <button class=\"font-bold py-2 px-4 w-1/3 bg-purple-400 text-lg text-white shadow-md rounded-lg\">\n                    Comment\n                </button>\n            </form>\n\n            <div id=\"task-comments\" class=\"pt-4\">\n                <comment-item\n                    @reloadComments=\"reloadComment()\"\n                    v-bind:key=\"comment._id\"\n                    v-for=\"comment in comments\"\n                    :comment=\"comment\"\n                />\n            </div>\n        </section>\n    </div>\n</template>\n<script>\nimport CommentItem from './CommentItem.vue';\nexport default {\n    components: { CommentItem },\n    Comment,\n    props: {\n        tutorialId: {\n            default: ''\n        }\n    },\n    data() {\n        return {\n            comments: {\n                default: ''\n            }\n        };\n    },\n    async mounted() {\n        this.grabAllComments();\n    },\n    methods: {\n        reloadComment() {\n            this.grabAllComments();\n        },\n        handleSubmit: async function postComment() {\n            try {\n                let comment = {\n                    value: document.getElementById('comment_content').value,\n                    userId: localStorage.getItem('userID')\n                };\n\n                var res = await this.axios.post('http://localhost:3000/discussion/' + this.tutorialId, comment, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('jwt_token')}`\n                    }\n                });\n                if (res.status === 200) {\n                    this.grabAllComments();\n                    document.getElementById('comment_content').value = '';\n                }\n            } catch (err) {\n                alert('An error occured: ', err);\n            }\n            return false;\n        },\n        async grabAllComments() {\n            try {\n                const jwt_token = localStorage.getItem('jwt_token');\n                if (jwt_token) {\n                    let result = await this.axios.post(\n                        'http://localhost:3000/verifyRefreshToken',\n                        {},\n                        {\n                            headers: {\n                                Authorization: `Bearer ${jwt_token}`\n                            }\n                        }\n                    );\n                    if (result.status === 200) {\n                        localStorage.setItem('jwt_token', result.data.jwt_token);\n                        result = await this.axios.get('http://localhost:3000/discussion/' + this.tutorialId, {\n                            headers: {\n                                Authorization: `Bearer ${localStorage.getItem('jwt_token')}`\n                            }\n                        });\n                        this.comments = result.data;\n                    }\n                } else {\n                    console.log('You are not authorized to access this page');\n                    localStorage.clear();\n                    this.$router.push('/login');\n                    this.$root.$refs.Navbar.reloadNav();\n                    console.log('Logged out');\n                }\n            } catch (err) {\n                console.log(err.message);\n                localStorage.clear();\n                this.$router.push('/login');\n                this.$root.$refs.Navbar.reloadNav();\n                console.log('Logged out');\n            }\n        }\n    }\n};\n</script>\n"]}]}