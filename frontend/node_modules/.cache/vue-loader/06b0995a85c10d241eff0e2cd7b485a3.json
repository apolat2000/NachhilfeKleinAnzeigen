{"remainingRequest":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/profile/ProfileForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/profile/ProfileForm.vue","mtime":1612773362627},{"path":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/OldProjects/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIHByb3BzOiB7CiAgICAgICAgcHJvZmlsZTogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIGRlZmF1bHQ6ICgpID0+IHt9CiAgICAgICAgfSwKICAgICAgICBwYWdlVGl0bGU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnRWRpdCBZb3VyIFByb2ZpbGUnCiAgICAgICAgfQogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2hhbmdlUFA6IGZhbHNlLAogICAgICAgICAgICBmaXJzdE5hbWU6ICcnLAogICAgICAgICAgICBsYXN0TmFtZTogJycsCiAgICAgICAgICAgIGltYWdlOiAnJywKICAgICAgICAgICAgZXhwZXJ0T2Y6IFtdLAogICAgICAgICAgICB2YWx1ZTogW10sCiAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICBidXR0b25WYWx1ZTogJ1NhdmUgQ2hhbmdlcycsCiAgICAgICAgICAgIHBhc3N3b3JkOiAnJwogICAgICAgIH07CiAgICB9LAogICAgYXN5bmMgY3JlYXRlZCgpIHsKICAgICAgICAvL3VzZXIgaXMgbm90IGF1dGhvcml6ZWQgPT4gUmVtYWluIGF0IGxvZ2luIHBhZ2UKICAgICAgICB2YXIgand0X3Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpOwogICAgICAgIGlmIChqd3RfdG9rZW4pIHsKICAgICAgICAgICAgbGV0IG5ld1Rva2VuID0gYXdhaXQgdGhpcy5heGlvcy5wb3N0KAogICAgICAgICAgICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC92ZXJpZnlSZWZyZXNoVG9rZW4nLAogICAgICAgICAgICAgICAge30sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0X3Rva2VufWAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChuZXdUb2tlbi5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2p3dF90b2tlbicsIG5ld1Rva2VuLmRhdGEuand0X3Rva2VuKTsKICAgICAgICAgICAgICAgIHRoaXMuZmlyc3ROYW1lID0gdGhpcy5wcm9maWxlLmZpcnN0X25hbWU7CiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROYW1lID0gdGhpcy5wcm9maWxlLmxhc3RfbmFtZTsKICAgICAgICAgICAgICAgIC8vdGhpcy5pbWFnZSA9IHRoaXMucHJvZmlsZS5pbWdQYXRoOwogICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMucHJvZmlsZS5leHBlcnRfb2ZfbGVjdHVyZXM7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGxldCBsZWN0dXJlcyA9IGF3YWl0IHRoaXMuYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvbGVjdHVyZXMvJywgewogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpfWAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGxlY3R1cmVzLmRhdGE7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBhY2Nlc3MgdGhpcyBwYWdlIScpOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2xvZ2luJyk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRyZWZzLk5hdmJhci5yZWxvYWROYXYoKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dnZWQgb3V0Jyk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygnWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBhY2Nlc3MgdGhpcyBwYWdlIScpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgICB0aGlzLiRyb290LiRyZWZzLk5hdmJhci5yZWxvYWROYXYoKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvZ2dlZCBvdXQnKTsKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIG9uQ2hhbmdlKHZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuZXhwZXJ0T2YgPSB2YWx1ZTsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5leHBlcnRPZik7CiAgICAgICAgfSwKICAgICAgICBwcm9jZXNzRmlsZShldmVudCkgewogICAgICAgICAgICB0aGlzLmltYWdlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlU3VibWl0OiBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9maWxlKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdmFyIGxlY3R1cmVzSUQgPSB0aGlzLnZhbHVlLm1hcChsZWN0ID0+IGxlY3QuX2lkKTsKICAgICAgICAgICAgICAgIGxlY3R1cmVzSUQgPSBbLi4ubmV3IFNldChsZWN0dXJlc0lEKV07IC8vbWFrZSBJRHMgaW4gYXJyYXkgdW5pcXVlCiAgICAgICAgICAgICAgICBjb25zdCBwcm9maWxlID0gewogICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IHRoaXMuZmlyc3ROYW1lLAogICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogdGhpcy5sYXN0TmFtZSwKICAgICAgICAgICAgICAgICAgICBleHBlcnRfb2ZfbGVjdHVyZXM6IGxlY3R1cmVzSUQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFuZ2VQUCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2UgPyAocHJvZmlsZS5pbWcgPSB0aGlzLmltYWdlKSA6IChwcm9maWxlLmltZ1BhdGggPSAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXNzd29yZC5sZW5ndGggPiAwKSBwcm9maWxlLnBhc3N3b3JkID0gdGhpcy5wYXNzd29yZDsKICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHByb2ZpbGUpLmZvckVhY2goa2V5ID0+IGZvcm1EYXRhLmFwcGVuZChrZXksIHByb2ZpbGVba2V5XSkpOwogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5heGlvcy5wdXQoYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC91c2VyLyR7dGhpcy5wcm9maWxlLl9pZH1gLCBmb3JtRGF0YSwgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2xvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3RfdG9rZW4nKX1gCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvcHJvZmlsZS8nICsgdGhpcy5wcm9maWxlLl9pZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBbiBlcnJvciBvY2N1cmVkIScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2ZpcnN0TmFtZScsIHRoaXMuZmlyc3ROYW1lKTsKICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJHJlZnMuTmF2YmFyLnJlbG9hZE5hdigpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTsK"},{"version":3,"sources":["ProfileForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProfileForm.vue","sourceRoot":"src/components/profile","sourcesContent":["<template>\n    <!-- component -->\n    <div class=\"bg-grey-lighter flex flex-col\">\n        <div class=\"container pt-16 max-w-sm mx-auto flex-2 flex flex-col items-center justify-center px-2\">\n            <div class=\"bg-white px-6 py-8 rounded shadow-md text-black w-full\">\n                <h1 class=\"mb-8 text-3xl text-center\">{{ pageTitle }}</h1>\n                <form @submit.prevent=\"handleSubmit\" method=\"POST\">\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"firstName\"\n                        id=\"firstName\"\n                        v-model=\"firstName\"\n                        placeholder=\"First name\"\n                        required\n                    />\n\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"lastName\"\n                        id=\"lastName\"\n                        v-model=\"lastName\"\n                        placeholder=\"Last name\"\n                        required\n                    />\n\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"password\"\n                        id=\"password\"\n                        v-model=\"password\"\n                        placeholder=\"New Password\"\n                    />\n\n                    <input type=\"checkbox\" id=\"changePP\" name=\"changePP\" v-model=\"changePP\" />\n                    <label for=\"changePP\"> Change Profile Picture</label><br />\n                    <div v-if=\"changePP\">\n                        <label for=\"image\"> Profile Picture </label>\n                        <input\n                            type=\"file\"\n                            single\n                            class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                            name=\"image\"\n                            id=\"image\"\n                            accept=\".png, .jpeg, .jpg\"\n                            @change=\"processFile($event)\"\n                        />\n                    </div>\n\n                    <multiselect\n                        v-model=\"value\"\n                        :options=\"this.options\"\n                        label=\"title\"\n                        track-by=\"title\"\n                        :multiple=\"true\"\n                        :close-on-select=\"true\"\n                        @input=\"onChange\"\n                        placeholder=\"Select lectures you are expert in\"\n                    ></multiselect>\n\n                    <input\n                        class=\"w-full text-center text-white py-3 rounded bg-green-500 text-black hover:bg-green-600 focus:outline-none my-1 cursor-pointer\"\n                        type=\"submit\"\n                        :value=\"buttonValue\"\n                    />\n                </form>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: {\n        profile: {\n            type: Object,\n            default: () => {}\n        },\n        pageTitle: {\n            type: String,\n            default: 'Edit Your Profile'\n        }\n    },\n    data() {\n        return {\n            changePP: false,\n            firstName: '',\n            lastName: '',\n            image: '',\n            expertOf: [],\n            value: [],\n            options: [],\n            buttonValue: 'Save Changes',\n            password: ''\n        };\n    },\n    async created() {\n        //user is not authorized => Remain at login page\n        var jwt_token = localStorage.getItem('jwt_token');\n        if (jwt_token) {\n            let newToken = await this.axios.post(\n                'http://localhost:3000/verifyRefreshToken',\n                {},\n                {\n                    headers: {\n                        Authorization: `Bearer ${jwt_token}`\n                    }\n                }\n            );\n            if (newToken.status === 200) {\n                localStorage.setItem('jwt_token', newToken.data.jwt_token);\n                this.firstName = this.profile.first_name;\n                this.lastName = this.profile.last_name;\n                //this.image = this.profile.imgPath;\n                this.value = this.profile.expert_of_lectures;\n                try {\n                    let lectures = await this.axios.get('http://localhost:3000/lectures/', {\n                        headers: {\n                            Authorization: `Bearer ${localStorage.getItem('jwt_token')}`\n                        }\n                    });\n                    this.options = lectures.data;\n                } catch (err) {\n                    console.log(err.message);\n                }\n            } else {\n                console.log('You are not authorized to access this page!');\n                localStorage.clear();\n                this.$router.push('/login');\n                this.$root.$refs.Navbar.reloadNav();\n                console.log('Logged out');\n            }\n        } else {\n            console.log('You are not authorized to access this page!');\n            localStorage.clear();\n            this.$router.push('/login');\n            this.$root.$refs.Navbar.reloadNav();\n            console.log('Logged out');\n        }\n    },\n    methods: {\n        onChange(value) {\n            this.expertOf = value;\n            console.log(this.expertOf);\n        },\n        processFile(event) {\n            this.image = event.target.files[0];\n        },\n        handleSubmit: async function updateProfile() {\n            try {\n                var lecturesID = this.value.map(lect => lect._id);\n                lecturesID = [...new Set(lecturesID)]; //make IDs in array unique\n                const profile = {\n                    first_name: this.firstName,\n                    last_name: this.lastName,\n                    expert_of_lectures: lecturesID\n                };\n                if (this.changePP) {\n                    this.image ? (profile.img = this.image) : (profile.imgPath = '');\n                }\n                if (this.password.length > 0) profile.password = this.password;\n                var result;\n                var formData = new FormData();\n                Object.keys(profile).forEach(key => formData.append(key, profile[key]));\n                result = await this.axios.put(`http://localhost:3000/user/${this.profile._id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('jwt_token')}`\n                    }\n                });\n\n                if (result.status === 200) {\n                    this.$router.push('/profile/' + this.profile._id);\n                } else {\n                    console.log('An error occured!');\n                }\n                localStorage.setItem('firstName', this.firstName);\n                this.$root.$refs.Navbar.reloadNav();\n            } catch (err) {\n                console.log(err.message);\n            }\n        }\n    }\n};\n</script>\n"]}]}