{"remainingRequest":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/ProfileForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/src/components/ProfileForm.vue","mtime":1612461286129},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ahmet/Desktop/Nachhilfekleinanzeigen/gruppe07/gruppe07/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIHByb3BzOiB7CiAgICAgICAgcHJvZmlsZTogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIGRlZmF1bHQ6ICgpID0+IHt9LAogICAgICAgIH0sCiAgICAgICAgcGFnZVRpdGxlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ0VkaXQgWW91ciBQcm9maWxlJywKICAgICAgICB9LAogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2hhbmdlUFA6IGZhbHNlLAogICAgICAgICAgICBmaXJzdE5hbWU6ICcnLAogICAgICAgICAgICBsYXN0TmFtZTogJycsCiAgICAgICAgICAgIGltYWdlOiAnJywKICAgICAgICAgICAgZXhwZXJ0T2Y6IFtdLAogICAgICAgICAgICB2YWx1ZTogW10sCiAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICBidXR0b25WYWx1ZTogJ1NhdmUgQ2hhbmdlcycsCiAgICAgICAgICAgIHBhc3N3b3JkOiAnJwogICAgICAgIH07CiAgICB9LAogICAgYXN5bmMgY3JlYXRlZCgpIHsKICAgICAgICAvL3VzZXIgaXMgbm90IGF1dGhvcml6ZWQgPT4gUmVtYWluIGF0IGxvZ2luIHBhZ2UKICAgICAgICB2YXIgand0X3Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpOwogICAgICAgIGlmIChqd3RfdG9rZW4pIHsKICAgICAgICAgICAgbGV0IG5ld1Rva2VuID0gYXdhaXQgdGhpcy5heGlvcy5wb3N0KAogICAgICAgICAgICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC92ZXJpZnlSZWZyZXNoVG9rZW4nLAogICAgICAgICAgICAgICAge30sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0X3Rva2VufWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKG5ld1Rva2VuLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnand0X3Rva2VuJywgbmV3VG9rZW4uZGF0YS5qd3RfdG9rZW4pOwogICAgICAgICAgICAgICAgdGhpcy5maXJzdE5hbWUgPSB0aGlzLnByb2ZpbGUuZmlyc3RfbmFtZTsKICAgICAgICAgICAgICAgIHRoaXMubGFzdE5hbWUgPSB0aGlzLnByb2ZpbGUubGFzdF9uYW1lOwogICAgICAgICAgICAgICAgLy90aGlzLmltYWdlID0gdGhpcy5wcm9maWxlLmltZ1BhdGg7CiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5wcm9maWxlLmV4cGVydF9vZl9sZWN0dXJlczsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGxlY3R1cmVzID0gYXdhaXQgdGhpcy5heGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sZWN0dXJlcy8nLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0X3Rva2VuJyl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBsZWN0dXJlcy5kYXRhOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gYWNjZXNzIHRoaXMgcGFnZSEnKTsKICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kcmVmcy5OYXZiYXIucmVsb2FkTmF2KCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9nZ2VkIG91dCcpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gYWNjZXNzIHRoaXMgcGFnZSEnKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvbG9naW4nKTsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kcmVmcy5OYXZiYXIucmVsb2FkTmF2KCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dnZWQgb3V0Jyk7CiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBvbkNoYW5nZSh2YWx1ZSkgewogICAgICAgICAgICB0aGlzLmV4cGVydE9mID0gdmFsdWU7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZXhwZXJ0T2YpOwogICAgICAgIH0sCiAgICAgICAgcHJvY2Vzc0ZpbGUoZXZlbnQpIHsKICAgICAgICAgICAgdGhpcy5pbWFnZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVN1Ym1pdDogYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZSgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZhciBsZWN0dXJlc0lEID0gdGhpcy52YWx1ZS5tYXAobGVjdCA9PiBsZWN0Ll9pZCk7CiAgICAgICAgICAgICAgICBsZWN0dXJlc0lEID0gWy4uLm5ldyBTZXQobGVjdHVyZXNJRCldOyAvL21ha2UgSURzIGluIGFycmF5IHVuaXF1ZQogICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZSA9IHsKICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiB0aGlzLmZpcnN0TmFtZSwKICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IHRoaXMubGFzdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgZXhwZXJ0X29mX2xlY3R1cmVzOiBsZWN0dXJlc0lELAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmKHRoaXMuY2hhbmdlUFApewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2UgPyBwcm9maWxlLmltZyA9IHRoaXMuaW1hZ2UgOiBwcm9maWxlLmltZ1BhdGggPSAnJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYodGhpcy5wYXNzd29yZC5sZW5ndGggPiAwKSBwcm9maWxlLnBhc3N3b3JkID0gdGhpcy5wYXNzd29yZAogICAgICAgICAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocHJvZmlsZSkuZm9yRWFjaChrZXkgPT4gZm9ybURhdGEuYXBwZW5kKGtleSwgcHJvZmlsZVtrZXldKSk7CiAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmF4aW9zLnB1dChgaHR0cDovL2xvY2FsaG9zdDozMDAwL3VzZXIvJHt0aGlzLnByb2ZpbGUuX2lkfWAsIGZvcm1EYXRhLCB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dF90b2tlbicpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL3Byb2ZpbGUvJyArIHRoaXMucHJvZmlsZS5faWQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQW4gZXJyb3Igb2NjdXJlZCEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmaXJzdE5hbWUnLCB0aGlzLmZpcnN0TmFtZSk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRyZWZzLk5hdmJhci5yZWxvYWROYXYoKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["ProfileForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProfileForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <!-- component -->\n    <div class=\"bg-grey-lighter flex flex-col\">\n        <div class=\"container pt-16 max-w-sm mx-auto flex-2 flex flex-col items-center justify-center px-2\">\n            <div class=\"bg-white px-6 py-8 rounded shadow-md text-black w-full\">\n                <h1 class=\"mb-8 text-3xl text-center\">{{ pageTitle }}</h1>\n                <form @submit.prevent=\"handleSubmit\" method=\"POST\">\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"firstName\"\n                        id=\"firstName\"\n                        v-model=\"firstName\"\n                        placeholder=\"First name\"\n                        required\n                    />\n\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"lastName\"\n                        id=\"lastName\"\n                        v-model=\"lastName\"\n                        placeholder=\"Last name\"\n                        required\n                    />\n\n                    <input\n                        type=\"text\"\n                        class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                        name=\"password\"\n                        id=\"password\"\n                        v-model=\"password\"\n                        placeholder=\"New Password\"\n                    />\n\n                    <input type=\"checkbox\" id=\"changePP\" name=\"changePP\" v-model=\"changePP\" />\n                    <label for=\"changePP\"> Change Profile Picture</label><br>\n                    <div v-if=\"changePP\">\n                        <label for=\"image\"> Profile Picture </label>\n                        <input\n                            type=\"file\"\n                            single\n                            class=\"block border border-grey-light w-full p-3 rounded mb-4\"\n                            name=\"image\"\n                            id=\"image\"\n                            accept=\".png, .jpeg, .jpg\"\n                            @change=\"processFile($event)\"\n                        />\n                    </div> \n\n                    <multiselect\n                        v-model=\"value\"\n                        :options=\"this.options\"\n                        label=\"title\"\n                        track-by=\"title\"\n                        :multiple=\"true\"\n                        :close-on-select=\"true\"\n                        @input=\"onChange\"\n                        placeholder=\"Select lectures you are expert in\"\n                    ></multiselect>\n\n                    <input\n                        class=\"w-full text-center text-white py-3 rounded bg-green-500 text-black hover:bg-green-600 focus:outline-none my-1 cursor-pointer\"\n                        type=\"submit\"\n                        :value=\"buttonValue\"\n                    />\n                </form>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: {\n        profile: {\n            type: Object,\n            default: () => {},\n        },\n        pageTitle: {\n            type: String,\n            default: 'Edit Your Profile',\n        },\n    },\n    data() {\n        return {\n            changePP: false,\n            firstName: '',\n            lastName: '',\n            image: '',\n            expertOf: [],\n            value: [],\n            options: [],\n            buttonValue: 'Save Changes',\n            password: ''\n        };\n    },\n    async created() {\n        //user is not authorized => Remain at login page\n        var jwt_token = localStorage.getItem('jwt_token');\n        if (jwt_token) {\n            let newToken = await this.axios.post(\n                'http://localhost:3000/verifyRefreshToken',\n                {},\n                {\n                    headers: {\n                        Authorization: `Bearer ${jwt_token}`,\n                    },\n                }\n            );\n            if (newToken.status === 200) {\n                localStorage.setItem('jwt_token', newToken.data.jwt_token);\n                this.firstName = this.profile.first_name;\n                this.lastName = this.profile.last_name;\n                //this.image = this.profile.imgPath;\n                this.value = this.profile.expert_of_lectures;\n                try {\n                    let lectures = await this.axios.get('http://localhost:3000/lectures/', {\n                        headers: {\n                            Authorization: `Bearer ${localStorage.getItem('jwt_token')}`,\n                        },\n                    });\n                    this.options = lectures.data;\n                } catch (err) {\n                    console.log(err.message);\n                }\n            } else {\n                console.log('You are not authorized to access this page!');\n                localStorage.clear();\n                this.$router.push('/login');\n                this.$root.$refs.Navbar.reloadNav();\n                console.log('Logged out');\n            }\n        } else {\n            console.log('You are not authorized to access this page!');\n            localStorage.clear();\n            this.$router.push('/login');\n            this.$root.$refs.Navbar.reloadNav();\n            console.log('Logged out');\n        }\n    },\n    methods: {\n        onChange(value) {\n            this.expertOf = value;\n            console.log(this.expertOf);\n        },\n        processFile(event) {\n            this.image = event.target.files[0];\n        },\n        handleSubmit: async function updateProfile() {\n            try {\n                var lecturesID = this.value.map(lect => lect._id);\n                lecturesID = [...new Set(lecturesID)]; //make IDs in array unique\n                const profile = {\n                    first_name: this.firstName,\n                    last_name: this.lastName,\n                    expert_of_lectures: lecturesID,\n                };\n                if(this.changePP){\n                    this.image ? profile.img = this.image : profile.imgPath = ''\n                }\n                if(this.password.length > 0) profile.password = this.password\n                var result;\n                var formData = new FormData();\n                Object.keys(profile).forEach(key => formData.append(key, profile[key]));\n                result = await this.axios.put(`http://localhost:3000/user/${this.profile._id}`, formData, {\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem('jwt_token')}`,\n                    },\n                });\n\n                if (result.status === 200) {\n                    this.$router.push('/profile/' + this.profile._id);\n                } else {\n                    console.log('An error occured!');\n                }\n                localStorage.setItem('firstName', this.firstName);\n                this.$root.$refs.Navbar.reloadNav();\n            } catch (err) {\n                console.log(err.message);\n            }\n        },\n    },\n};\n</script>\n"]}]}